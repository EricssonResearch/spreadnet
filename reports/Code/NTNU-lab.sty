%                                                           ,,           ,,
% `7MN.   `7MF'MMP""MM""YMM `7MN.   `7MF'`7MMF'   `7MF'   `7MM          *MM
%   MMN.    M  P'   MM   `7   MMN.    M    MM       M       MM           MM
%   M YMb   M       MM        M YMb   M    MM       M       MM   ,6"Yb.  MM,dMMb.
%   M  `MN. M       MM        M  `MN. M    MM       M       MM  8)   MM  MM    `Mb
%   M   `MM.M       MM        M   `MM.M    MM       M mmmmm MM   ,pm9MM  MM     M8
%   M     YMM       MM        M     YMM    YM.     ,M       MM  8M   MM  MM.   ,M9
% .JML.    YM     .JMML.    .JML.    YM     `bmmmmd"'     .JMML.`Moo9^Yo.P^YbmdP'
%
%---------------------------------------------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% *** LaTeX-template for Laboratory reports in physics,
%
%                           V.01.1 // Version 01, with 1 update(s) or patch(es)
%
% Based on an example report from NTNU in 2011 (in Norwegian), updated in 2019.
% Updated April 2022. (New sections are marked with U.01 // Update 01)
%
%---------------------------------------------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%       Defining the .sty file and input encoding // U.01
%_______________________________________________________________
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{Code/NTNU-lab}[2022/04/21 NTNU Laboratory Report Package]
\RequirePackage[utf8]{inputenc}
%................................................................
%
%                            Packages
%_______________________________________________________________
\RequirePackage{graphicx}       			                        	% To include figures.
\RequirePackage{mathtools,amssymb} 			                        	% To write math.
\RequirePackage{siunitx}				                            	% For SI units (command \SI)
	\sisetup{exponent-product = \cdot}                              	% Dot as multiplication sign (for scientific notation: 1*10^2)
 	\sisetup{output-decimal-marker  =  {.}}                         	% Change to {,} for comma as decimal sign
 	\sisetup{separate-uncertainty = true}                              	% Plus-minus in uncertainties (in stead of parenthesis).
\RequirePackage{booktabs}                     	                    	% Access nicer lines (for use in tables).
\RequirePackage[font=small,labelfont=bf]{caption}	                	% Adjusting figure text and table text
%................................................................
%
%                    New packages // U.01
%_______________________________________________________________
\makeatletter
    \let\c@author\undefined % These commands are defined by elsearticle
    \let\bibfont\undefined  % and must be undefined to properly load biblatex
\makeatother
\RequirePackage[backend=biber,style=vancouver, sorting=nty]{biblatex}      % Bibliography
\RequirePackage{hyperref}                                               % Hyperref
\hypersetup{hidelinks}                                                  % Fix for color boxes around hyperref in text
\RequirePackage{tablefootnote}                                          % Footnotes for tables
\RequirePackage[arrowdel]{physics}                                      % Display div, curl, laplacian.
\RequirePackage{commath}
\RequirePackage{subfigure}                                              % Subfig for multiple figures inside a figure
\RequirePackage{float}                                                  % Improves floats (figures, tables, etc.)
\RequirePackage{appendix}                                               % For appendix
\RequirePackage[shortcuts]{extdash}                                     % Hyphen and dash commands to not disrupt hyphenation
\RequirePackage{hologo}                                                 % For TeX engine logos (pdfTEX, LuaTEX, TEX, etc.)
%................................................................
%
%        Colours // U.01
%_______________________________________________________________
\RequirePackage[table]{xcolor}
\definecolor{NTNU_blue}{HTML}{2E5AAC}
%................................................................
%
%        Package that must be loaded after colours // U.01
%_______________________________________________________________
\RequirePackage[siunitx]{circuitikz}                                    % Tikz + draw circuits w/ SI unit labels
\usetikzlibrary{decorations.pathreplacing}
%................................................................
%
%        Environment for python code // U.01
%_______________________________________________________________
\RequirePackage{minted}
\usemintedstyle{colorful}
\definecolor{LightGray}{rgb}{0.95,0.95,0.95}
%................................................................
%
%        Date fix (to show date in frontmatter) // U.01
%_______________________________________________________________
\RequirePackage{datetime}
\RequirePackage{etoolbox}
    % Commands for how a date is displayed:
    \newdateformat{MonthYearDateFormat}{%
        \monthname[\THEMONTH], \THEYEAR
        }
    \newdateformat{DayMonthYearDateFormat}{%
        \THEDAY \ \monthname[\THEMONTH], \THEYEAR
        }
    \newdateformat{YearDateFormat}{%
        \THEYEAR
        }
\DeclareOption{DatePublished}{%
%
    \patchcmd{\MaketitleBox}{\footnotesize\itshape\elsaddress\par\vskip36pt}{\footnotesize\itshape\elsaddress\par\parbox[b][36pt]{\linewidth}{\vfill\hfill\textnormal{\today}\hfill\null\vfill}}{}{}%
    \patchcmd{\pprintMaketitle}{\footnotesize\itshape\elsaddress\par\vskip36pt}{\footnotesize\itshape\elsaddress\par\parbox[b][36pt]{\linewidth}{\vfill\hfill\textnormal{\today}\hfill\null\vfill}}{}{}%
}
%
\DeclareOption*{\PackageWarning{examplepackage}{Unknown ‘\CurrentOption’}}
\ProcessOptions\relax
%................................................................
%
%                    Abstract environment
%_______________________________________________________________
\newcommand{\NameOfAbstract}[1]{\renewcommand{\abstractname}{#1}} % U.01 Defined a macro for naming abstract.
\renewenvironment{abstract}{\global\setbox\absbox=\vbox\bgroup
\hsize=\textwidth\def\baselinestretch{1}%
\noindent\unskip\textbf{\abstractname}                                       % Displayed title of abstract.
\par\medskip\noindent\unskip\ignorespaces}
{\egroup}
%
\makeatletter
\let\@afterindenttrue\@afterindentfalse
\makeatother
%
%................................................................
%
% Commands to make it easier for LaTeX to place tables and figures where you want them
%_______________________________________________________________
\setcounter{totalnumber}{5}
\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.95}
\renewcommand{\bottomfraction}{0.95}
\renewcommand{\floatpagefraction}{0.35}
%
%................................................................
%
% Removes "Preprint submitted to..."-text generated by elsarticle
%_______________________________________________________________
\makeatletter
\def\ps@pprintTitle{%
 \let\@oddhead\@empty
 \let\@evenhead\@empty
 \def\@oddfoot{}%
 \let\@evenfoot\@oddfoot}
\makeatother
%
%................................................................
%
%                       Margin fixes // U.01
%_______________________________________________________________
\RequirePackage{geometry}
\RequirePackage{calc} % To calculate textwidth = <pagewidth> - <margins>.
\geometry{right=25mm,textwidth={\paperwidth - 50mm}}                % Standard 2.5cm margins, can be adjusted.
%
%................................................................
%
%
%       Defining some useful math commands // U.01
%_______________________________________________________________
%
% Differential operator d, for integrals and derivatives:
\makeatletter
\DeclareRobustCommand{\dd}{\relax\ifmmode\daux\relax\fi}
\newcommand*{\daux}{\mathop{}\!{\operator@font d}}
\makeatother
%
% = with 'def' on top (Definition equal sign)
\DeclareRobustCommand{\defeq}{\relax\ifmmode\mathrel{\mathpalette\defeqaux\relax}\fi}
\newcommand*{\defeqaux}{\overset{\text{def}}{=}}
%
% = with wide '^' (\whateq)
\DeclareRobustCommand{\whateq}{\relax\ifmmode\mathrel{\mathpalette\whateqaux\relax}\fi}
\newcommand*{\whateqaux}{\widehat{=}}
%
% = with normal '^' (\hateq)
\DeclareRobustCommand{\hateq}{\relax\ifmmode\mathrel{\mathpalette\hateqaux\relax}\fi}
\newcommand*{\hateqaux}{\hat{=}}
%
% := command
\DeclareRobustCommand{\coleq}{\relax\ifmmode\mathrel{\mathpalette\coleqaux\relax}\fi}
\newcommand*{\coleqaux}{\vcentcolon=}
%
% = with 'm' on top (meaning: measured by)
\DeclareRobustCommand{\meq}{\relax\ifmmode\mathrel{\mathpalette\meqaux\relax}\fi}
\newcommand*{\meqaux}{\overset{\text{m}}{=}}
%
% = with '?' on top, denotes uncertainty
\DeclareRobustCommand{\qmeq}{\relax\ifmmode\mathrel{\mathpalette\qmeqaux\relax}\fi}
\newcommand*{\qmeqaux}{\overset{\text{?}}{=}}
%
%...............................................................
%
%           Appendix footnotes // U.01
%_______________________________________________________________
\newcounter{appendixfoot}
\setcounter{appendixfoot}{1}
\newcommand{\appendixfootnote}[1]{\renewcommand{\thefootnote}{\roman{appendixfoot}}\footnote{#1}\stepcounter{appendixfoot}}
%
%...............................................................
%
%       Boxed environments + theorems // U.01
%_______________________________________________________________
% Info Box (title and numbered box):
\RequirePackage{tcolorbox}
\definecolor{bg_blue}{HTML}{cde4ff}
\definecolor{frame_grey}{HTML}{404040}
\newcounter{infoboxCounter}
\setcounter{infoboxCounter}{0}
\newcommand{\infoboxbgcolor}{}
\newcommand{\infoboxframecolor}{}
\newcommand{\SetInfoBoxBgColor}[1]{\renewcommand{\infoboxbgcolor}{#1}} % command to change box color
\newcommand{\SetInfoBoxFrameColor}[1]{\renewcommand{\infoboxframecolor}{#1}} % command to change frame color
\SetInfoBoxBgColor{bg_blue} % default background color
\SetInfoBoxFrameColor{NTNU_blue} % default frame color
\newtcolorbox[use counter=infoboxCounter,
                number within= section
                ]
                {infobox}[2][]%
    {boxrule = 1.5pt,
    colback=\infoboxbgcolor,
    colframe = \infoboxframecolor,
    rounded corners,
    arc = 6pt,   % corners roundness
    title=\bfseries\sffamily #2 \hfill \theinfoboxCounter,
    #1
}
% Simple colored box:
\newcommand{\simpleboxcolor}{} % defining these makes it possible to re-define later.
\newcommand{\simpleframecolor}{}
\newcommand{\SetSimpleBoxColor}[1]{\renewcommand{\simpleboxcolor}{#1}\renewcommand{\simpleframecolor}{#1!85!black}}
\SetSimpleBoxColor{LightGray} % default box color
\newtcolorbox{simplebox}{
    boxrule = 0pt,
    leftrule = 3pt,
    colframe = \simpleframecolor,
    colback=\simpleboxcolor,
    rounded corners,
    arc = 1pt   % corners roundness
}
% Theorem environments:
\newtheorem{Sclaw}{Scientific law}
\newtheorem{naturlov}{Naturlov}
%
%...............................................................
%
%                        TEST
%_______________________________________________________________
% Write down your own extensions of the .sty file here:


%
%
\endinput
%
%---------------------------------------------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                           Appendix
%_______________________________________________________________
% ASCII-art created with ASCII art generator (name of style used: Georgia11)
% Link to ASCII art generator: https://www.kammerl.de/ascii/AsciiSignature.php
%
%       File history:
%-------------------------------
% -- Base version created in 2019
% -- U.01 Update by Vebjørn:
%       - removed the original comments (in norwegian)
%       + made the code into a .sty file
%       + added more useful packages
%       + added environment for displaying python code
%       + added option to display date at start of document
%       + fixed margins in document (standard 2.5cm margins)
%       + added useful mathmode commands
%       + added appendix footnotes in roman numerals
%       + added boxes and theorems
%
%
%    Links and resources:
%-------------------------------
% -- How do I get LaTeX to hyphenate a word that contains a dash?
%           https://stackoverflow.com/questions/2193307/how-do-i-get-latex-to-hyphenate-a-word-that-contains-a-dash
% -- Placing date on the front matter (elsarticle document class)
%           https://tex.stackexchange.com/questions/207487/placing-date-on-the-front-matter-elsarticle-document-class
